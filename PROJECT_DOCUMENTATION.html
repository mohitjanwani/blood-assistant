<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blood Assistant AI - Complete Project Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        header {
            text-align: center;
            border-bottom: 4px solid #dc2626;
            padding-bottom: 30px;
            margin-bottom: 40px;
        }
        
        h1 {
            color: #dc2626;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .date-info {
            color: #999;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        h2 {
            color: #dc2626;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #fee2e2;
        }
        
        h3 {
            color: #333;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        table th, table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        table th {
            background-color: #dc2626;
            color: white;
            font-weight: bold;
        }
        
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .code-block {
            background-color: #f5f5f5;
            border-left: 4px solid #dc2626;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        
        .highlight {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        
        .tech-stack {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .tech-item {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #dc2626;
        }
        
        .tech-item strong {
            color: #dc2626;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .feature-card {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }
        
        .feature-card strong {
            color: #dc2626;
        }
        
        .architecture-box {
            background-color: #f5f5f5;
            border: 2px dashed #dc2626;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .flow-diagram {
            background-color: #f0f7ff;
            border: 2px solid #0066cc;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            text-align: center;
        }
        
        .flow-diagram p {
            margin: 5px 0;
            font-weight: bold;
            color: #0066cc;
        }
        
        .page-break {
            page-break-after: always;
            margin: 40px 0;
            border-top: 2px dashed #ccc;
            padding-top: 40px;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #fee2e2;
            color: #999;
            font-size: 0.9em;
        }
        
        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                max-width: 100%;
            }
            
            .page-break {
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ©¸ Blood Assistant AI</h1>
            <p class="subtitle">Complete Project Documentation</p>
            <p class="subtitle">Intelligent Blood Donation Eligibility Assessment System</p>
            <p class="date-info">Generated: November 27, 2025</p>
            <p class="date-info">Repository: <strong>blood-assistant</strong> | Owner: <strong>mohitjanwani</strong></p>
        </header>

        <!-- Project Overview -->
        <h2>1. Project Overview</h2>
        <p>
            <strong>Blood Assistant AI</strong> is a sophisticated Django-based web application that leverages artificial intelligence, 
            machine learning, and real-time data to help users assess their eligibility for blood donation. The system provides 
            interactive conversational guidance, answers medical questions, locates nearby blood banks and donation camps, 
            and generates comprehensive eligibility reports.
        </p>
        
        <h3>Key Objectives</h3>
        <ul>
            <li>Provide instant blood donation eligibility assessment</li>
            <li>Answer medical questions using AI-powered conversational interface</li>
            <li>Locate blood banks and donation camps in real-time</li>
            <li>Generate downloadable eligibility reports</li>
            <li>Support multiple languages and accessibility features</li>
            <li>Ensure medical accuracy and compliance with health guidelines</li>
        </ul>

        <!-- Technology Stack -->
        <h2>2. Technology Stack</h2>
        
        <h3>Backend Technologies</h3>
        <div class="tech-stack">
            <div class="tech-item">
                <strong>Framework:</strong> Django 5.2.8
                <p>Python web framework for building scalable applications</p>
            </div>
            <div class="tech-item">
                <strong>API Framework:</strong> Django REST Framework
                <p>Powerful toolkit for building RESTful APIs</p>
            </div>
            <div class="tech-item">
                <strong>Database:</strong> SQLite3
                <p>Lightweight relational database for data persistence</p>
            </div>
            <div class="tech-item">
                <strong>Language:</strong> Python 3.x
                <p>High-level programming language for backend development</p>
            </div>
        </div>
        
        <h3>AI/ML Technologies</h3>
        <div class="tech-stack">
            <div class="tech-item">
                <strong>Model Hub:</strong> Transformers 4.30+
                <p>Hugging Face library for state-of-the-art NLP models</p>
            </div>
            <div class="tech-item">
                <strong>Language Model:</strong> Google FLAN-T5-Large
                <p>Sequence-to-sequence model for text generation and Q&A</p>
            </div>
            <div class="tech-item">
                <strong>Embeddings:</strong> Sentence Transformers
                <p>Pre-trained models for semantic textual similarity</p>
            </div>
            <div class="tech-item">
                <strong>Deep Learning:</strong> PyTorch
                <p>Deep learning framework (CPU or GPU support)</p>
            </div>
            <div class="tech-item">
                <strong>Vector Search:</strong> FAISS-CPU
                <p>Efficient similarity search library (optional)</p>
            </div>
        </div>
        
        <h3>Frontend Technologies</h3>
        <div class="tech-stack">
            <div class="tech-item">
                <strong>Markup:</strong> HTML5
                <p>Semantic web markup language</p>
            </div>
            <div class="tech-item">
                <strong>Styling:</strong> TailwindCSS
                <p>Utility-first CSS framework for responsive design</p>
            </div>
            <div class="tech-item">
                <strong>Scripting:</strong> Vanilla JavaScript
                <p>Client-side interactivity and API communication</p>
            </div>
            <div class="tech-item">
                <strong>Icons:</strong> Material Icons
                <p>Google Material Design icon library</p>
            </div>
            <div class="tech-item">
                <strong>Voice:</strong> Web Speech API
                <p>Browser-native speech recognition and synthesis</p>
            </div>
        </div>

        <h3>External Services & APIs</h3>
        <ul>
            <li><strong>Tavily Search API:</strong> Real-time web search for blood banks and donation camps</li>
            <li><strong>Indian Red Cross:</strong> Official blood donation camp information</li>
            <li><strong>Hugging Face Models Hub:</strong> Pre-trained transformer models</li>
        </ul>

        <h3>Deployment & Server</h3>
        <ul>
            <li><strong>Application Server:</strong> Gunicorn (production WSGI server)</li>
            <li><strong>Configuration:</strong> python-dotenv (environment variables)</li>
            <li><strong>Development:</strong> Django development server</li>
        </ul>

        <div class="page-break"></div>

        <!-- Project Architecture -->
        <h2>3. Project Architecture</h2>
        
        <h3>Directory Structure</h3>
        <div class="architecture-box">blood-assistant/
â”œâ”€â”€ db.sqlite3                    # SQLite Database
â”œâ”€â”€ manage.py                     # Django CLI
â”œâ”€â”€ requirements.txt              # Python Dependencies
â”‚
â”œâ”€â”€ blood_assistant/              # Main Django Project Configuration
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py              # Django settings & configuration
â”‚   â”œâ”€â”€ urls.py                  # Main URL routing
â”‚   â”œâ”€â”€ wsgi.py                  # WSGI application
â”‚   â”œâ”€â”€ asgi.py                  # ASGI application
â”‚   â””â”€â”€ __pycache__/
â”‚
â””â”€â”€ assistant/                    # Main Application (Django App)
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ admin.py                 # Django admin configuration
    â”œâ”€â”€ apps.py                  # App configuration
    â”œâ”€â”€ models.py                # Database models
    â”œâ”€â”€ views.py                 # Business logic & API endpoints
    â”œâ”€â”€ urls.py                  # App URL routing
    â”œâ”€â”€ tests.py                 # Unit tests
    â”œâ”€â”€ __pycache__/
    â”‚
    â”œâ”€â”€ migrations/              # Database schema migrations
    â”‚   â”œâ”€â”€ __init__.py
    â”‚   â”œâ”€â”€ 0001_initial.py
    â”‚   â”œâ”€â”€ 0002_userhealthprofile_allergies_details_and_more.py
    â”‚   â””â”€â”€ __pycache__/
    â”‚
    â””â”€â”€ templates/               # HTML Templates
        â””â”€â”€ assistant/
            â”œâ”€â”€ chat.html        # Main interactive chat interface
            â”œâ”€â”€ home.html        # Home page
            â””â”€â”€ register.html    # User registration
        </div>

        <h3>MVC Architecture</h3>
        <div class="highlight">
            <strong>Model:</strong> UserHealthProfile (stores user health data for eligibility assessment)<br>
            <strong>View:</strong> Django views handle API endpoints and request processing<br>
            <strong>Controller:</strong> URL routing in urls.py directs requests to appropriate views
        </div>

        <h3>Application Flow</h3>
        <div class="flow-diagram">
            <p>User Input (Frontend)</p>
            <p>â†“</p>
            <p>Send via Fetch API (JSON Request)</p>
            <p>â†“</p>
            <p>Django View (API Endpoint)</p>
            <p>â†“</p>
            <p>Process (AI Model / Database Operation)</p>
            <p>â†“</p>
            <p>Return Response (JSON)</p>
            <p>â†“</p>
            <p>Update Frontend (DOM / UI)</p>
        </div>

        <div class="page-break"></div>

        <!-- Database Model -->
        <h2>4. Database Model: UserHealthProfile</h2>
        
        <p>
            The <strong>UserHealthProfile</strong> model stores comprehensive health information for blood donation eligibility assessment. 
            It supports both authenticated and anonymous users through session-based tracking.
        </p>
        
        <h3>Model Fields</h3>
        
        <h4>User & Session Information</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td>user</td>
                <td>ForeignKey</td>
                <td>Link to Django User model (null=True for anonymous users)</td>
            </tr>
            <tr>
                <td>session_id</td>
                <td>CharField (255)</td>
                <td>Unique session identifier for anonymous users</td>
            </tr>
        </table>
        
        <h4>Personal Demographics</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Range/Format</th>
            </tr>
            <tr>
                <td>name</td>
                <td>CharField (100)</td>
                <td>User's full name</td>
            </tr>
            <tr>
                <td>age</td>
                <td>IntegerField</td>
                <td>Age in years (18-65 for eligibility)</td>
            </tr>
            <tr>
                <td>weight</td>
                <td>FloatField</td>
                <td>Weight in kg (minimum 50 kg required)</td>
            </tr>
            <tr>
                <td>gender</td>
                <td>CharField (20)</td>
                <td>Male, Female, Other</td>
            </tr>
            <tr>
                <td>blood_category</td>
                <td>CharField (10)</td>
                <td>A+, A-, B+, B-, AB+, AB-, O+, O-</td>
            </tr>
        </table>
        
        <h4>Medical Conditions</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>has_diabetes</td>
                <td>BooleanField</td>
                <td>Diabetes status (Not eligible if uncontrolled)</td>
            </tr>
            <tr>
                <td>has_anemia</td>
                <td>BooleanField</td>
                <td>Anemia status (Not eligible)</td>
            </tr>
            <tr>
                <td>has_chronic_diseases</td>
                <td>BooleanField</td>
                <td>Chronic disease status</td>
            </tr>
            <tr>
                <td>chronic_diseases_details</td>
                <td>TextField</td>
                <td>Details of chronic diseases</td>
            </tr>
            <tr>
                <td>hemoglobin_level</td>
                <td>CharField (20)</td>
                <td>Minimum: 12.5 g/dL (F), 13.5 g/dL (M)</td>
            </tr>
            <tr>
                <td>blood_pressure</td>
                <td>CharField (50)</td>
                <td>Normal range: 90/60 to 120/80 mmHg</td>
            </tr>
        </table>
        
        <h4>Infectious & Communicable Diseases</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>has_infectious_disease</td>
                <td>BooleanField</td>
                <td>HIV, Hepatitis, or other infectious diseases</td>
            </tr>
            <tr>
                <td>infectious_disease_details</td>
                <td>TextField</td>
                <td>Type and details of infectious disease</td>
            </tr>
            <tr>
                <td>had_corona</td>
                <td>BooleanField</td>
                <td>COVID-19 history (Wait 28 days after recovery)</td>
            </tr>
        </table>
        
        <h4>Medications & Allergies</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>taking_medications</td>
                <td>BooleanField</td>
                <td>Currently on medication</td>
            </tr>
            <tr>
                <td>medications_details</td>
                <td>TextField</td>
                <td>List and details of medications</td>
            </tr>
            <tr>
                <td>has_allergies</td>
                <td>BooleanField</td>
                <td>Presence of allergies</td>
            </tr>
            <tr>
                <td>allergies_details</td>
                <td>TextField</td>
                <td>Types of allergies</td>
            </tr>
        </table>
        
        <h4>Blood Donation History</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>donated_before</td>
                <td>BooleanField</td>
                <td>Previous blood donation history</td>
            </tr>
            <tr>
                <td>last_donation_date</td>
                <td>CharField (50)</td>
                <td>Date of last donation (minimum 56 days between donations)</td>
            </tr>
        </table>
        
        <h4>Lifestyle & Medical Procedures</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>has_tattoo_piercing</td>
                <td>BooleanField</td>
                <td>Recent tattoo or piercing (Wait 6 months)</td>
            </tr>
            <tr>
                <td>tattoo_piercing_date</td>
                <td>CharField (50)</td>
                <td>Date of tattoo or piercing</td>
            </tr>
            <tr>
                <td>has_surgery_recently</td>
                <td>BooleanField</td>
                <td>Recent surgery (Wait 6 months)</td>
            </tr>
            <tr>
                <td>surgery_details</td>
                <td>TextField</td>
                <td>Type and date of surgery</td>
            </tr>
        </table>
        
        <h4>Female-Specific Health</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>is_pregnant</td>
                <td>BooleanField</td>
                <td>Pregnancy status (Not eligible)</td>
            </tr>
            <tr>
                <td>is_breastfeeding</td>
                <td>BooleanField</td>
                <td>Breastfeeding status (Not eligible)</td>
            </tr>
        </table>
        
        <h4>Assessment Results</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Values</th>
            </tr>
            <tr>
                <td>eligibility_status</td>
                <td>CharField (50)</td>
                <td>"Eligible" or "Not Eligible"</td>
            </tr>
            <tr>
                <td>eligibility_reasons</td>
                <td>TextField</td>
                <td>Detailed reasons for eligibility decision</td>
            </tr>
            <tr>
                <td>completed</td>
                <td>BooleanField</td>
                <td>Questionnaire completion status</td>
            </tr>
        </table>
        
        <h4>Timestamps</h4>
        <table>
            <tr>
                <th>Field Name</th>
                <th>Type</th>
                <th>Description</th>
            </tr>
            <tr>
                <td>created_at</td>
                <td>DateTimeField</td>
                <td>Record creation timestamp (auto)</td>
            </tr>
            <tr>
                <td>updated_at</td>
                <td>DateTimeField</td>
                <td>Last update timestamp (auto)</td>
            </tr>
        </table>

        <div class="page-break"></div>

        <!-- API Endpoints -->
        <h2>5. API Endpoints</h2>
        
        <h3>1. Chat API: /api/chat/</h3>
        <div class="code-block">
Method: POST
Content-Type: application/json

Request Body:
{
    "question": "What is the minimum age to donate blood?"
}

Response:
{
    "answer": "The minimum age to donate blood is typically 18 years old...",
    "source": "Generative AI",
    "confidence": 1.0,
    "recommendations": [
        "What are the weight requirements?",
        "Are there age restrictions?",
        "What health conditions prevent donation?"
    ]
}
        </div>
        
        <p>
            <strong>Purpose:</strong> Answer medical questions about blood donation without requiring questionnaire flow.<br>
            <strong>Flow:</strong>
        </p>
        <ol>
            <li>User submits a question</li>
            <li>System classifies intent (SEARCH or EXPLAIN)</li>
            <li>If SEARCH: Uses Tavily API to find blood banks/camps in specified city</li>
            <li>If EXPLAIN: Uses FLAN-T5 model to generate informative answer</li>
            <li>Returns response with confidence score and AI-generated recommendations</li>
        </ol>

        <h3>2. Report API: /api/report/</h3>
        <div class="code-block">
Method: POST
Content-Type: application/json

Request Body (first call - starts assessment):
{
    "answer": "start"
}

Request Body (subsequent calls - answer questions):
{
    "answer": "25"  // User's answer to current question
}

Response (during question flow):
{
    "answer": "What is your weight? (in kg)",
    "in_question_flow": true,
    "question_number": 3,
    "total_questions": 26
}

Response (after completion):
{
    "answer": "Thank you for providing all the information!...",
    "in_question_flow": false,
    "completed": true,
    "eligible": true,
    "reasons": ["You meet all eligibility criteria..."],
    "profile_id": 1
}
        </div>
        
        <p>
            <strong>Purpose:</strong> Generate comprehensive blood donation eligibility assessment report.<br>
            <strong>Flow:</strong>
        </p>
        <ol>
            <li>Initiates 26-question questionnaire</li>
            <li>Validates each answer for format and content accuracy</li>
            <li>Skips conditional questions based on previous answers</li>
            <li>Saves data to UserHealthProfile model</li>
            <li>Upon completion, runs eligibility check algorithm</li>
            <li>Returns detailed eligibility assessment with reasons</li>
        </ol>

        <h3>3. Reset Assessment: /api/reset/</h3>
        <div class="code-block">
Method: POST

Response:
{
    "status": "success",
    "message": "Assessment reset. Ready to start fresh."
}
        </div>

        <h3>4. Download Report: /download-report/&lt;profile_id&gt;/</h3>
        <div class="code-block">
Method: GET
Response: HTML file (can be printed to PDF)

Downloads an HTML document containing:
- Personal information
- Health data
- Assessment results
- Eligibility status with detailed reasons
        </div>

        <div class="page-break"></div>

        <!-- AI Models -->
        <h2>6. AI Models & Methods</h2>
        
        <h3>Model 1: Google FLAN-T5-Large</h3>
        <h4>Specifications</h4>
        <ul>
            <li><strong>Type:</strong> Sequence-to-Sequence (Seq2Seq) Text Generation</li>
            <li><strong>Architecture:</strong> Transformer-based encoder-decoder</li>
            <li><strong>Parameters:</strong> 770 million</li>
            <li><strong>Training Data:</strong> Fine-tuned on 1.8M tasks from Google's task collection</li>
            <li><strong>Purpose:</strong> Generate conversational responses to medical questions</li>
        </ul>
        
        <h4>Configuration</h4>
        <div class="code-block">
Pipeline: text2text-generation
Model ID: google/flan-t5-large

Parameters:
- max_length: 256 tokens
- temperature: 0.8 (balanced creativity)
- top_p: 0.95 (nucleus sampling)
- do_sample: True (stochastic decoding)
        </div>
        
        <p>
            <strong>Usage:</strong> Generates informative answers to user questions about blood donation, health conditions, 
            medical procedures, and eligibility criteria.
        </p>

        <h3>Model 2: Intent Classification</h3>
        <h4>Method</h4>
        <ul>
            <li><strong>Approach:</strong> Hybrid - Keyword Detection + LLM-based Classification</li>
            <li><strong>Keywords for SEARCH:</strong> "find", "location", "near me", "city", "banks", "camps", "centers"</li>
            <li><strong>Keywords for EXPLAIN:</strong> "what", "why", "how", "risk", "benefit", "explain", "define"</li>
        </ul>
        
        <p>
            <strong>Flow:</strong> If keyword matching is inconclusive, FLAN-T5 router prompt classifies the user's intent as either 
            SEARCH (for location-based queries) or EXPLAIN (for conceptual/medical questions).
        </p>

        <h3>Model 3: Recommendation Engine</h3>
        <h4>Method</h4>
        <ul>
            <li><strong>Type:</strong> FLAN-T5 Prompt Engineering</li>
            <li><strong>Purpose:</strong> Generate 3 specific follow-up questions based on answer context</li>
        </ul>
        
        <h4>Process</h4>
        <div class="code-block">
Input: User's answer text (limited to first 400 characters)

Prompt Template:
"Read this medical text: [text]
Task: Create 3 specific follow-up questions
Rules:
1. Questions must be about the text
2. No generic phrases like 'Tell me more'
3. Make them complete questions

Output Format: Q1? Q2? Q3?"

Output: List of 3 specific follow-up questions
        </div>

        <h3>Model 4: Eligibility Assessment Algorithm</h3>
        <p>
            <strong>Type:</strong> Rule-based expert system with medical guidelines compliance
        </p>
        
        <h4>Assessment Criteria</h4>
        <table>
            <tr>
                <th>Criterion</th>
                <th>Eligible Value</th>
                <th>Ineligible/Warning</th>
                <th>Guideline Source</th>
            </tr>
            <tr>
                <td>Age</td>
                <td>18-65 years</td>
                <td>&lt;18 or &gt;65</td>
                <td>WHO Standards</td>
            </tr>
            <tr>
                <td>Weight</td>
                <td>â‰¥50 kg</td>
                <td>&lt;50 kg</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Hemoglobin</td>
                <td>F: â‰¥12.5 g/dL, M: â‰¥13.5 g/dL</td>
                <td>Below minimum</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Diabetes</td>
                <td>Not present or controlled</td>
                <td>Uncontrolled</td>
                <td>Medical Guidelines</td>
            </tr>
            <tr>
                <td>Anemia</td>
                <td>Not present</td>
                <td>Present</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Infectious Disease</td>
                <td>Not present</td>
                <td>HIV, Hepatitis present</td>
                <td>WHO Guidelines</td>
            </tr>
            <tr>
                <td>COVID-19</td>
                <td>Never or &gt;28 days post-recovery</td>
                <td>&lt;28 days recovery</td>
                <td>CDC Guidelines</td>
            </tr>
            <tr>
                <td>Pregnancy</td>
                <td>Not pregnant</td>
                <td>Currently pregnant</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Breastfeeding</td>
                <td>Not breastfeeding</td>
                <td>Currently breastfeeding</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Tattoo/Piercing</td>
                <td>None or &gt;6 months ago</td>
                <td>&lt;6 months</td>
                <td>Medical Standard</td>
            </tr>
            <tr>
                <td>Surgery</td>
                <td>None or &gt;6 months ago</td>
                <td>&lt;6 months</td>
                <td>Medical Standard</td>
            </tr>
        </table>

        <div class="page-break"></div>

        <!-- Question Flow -->
        <h2>7. Eligibility Assessment Question Flow</h2>
        
        <p>
            The system asks 26 comprehensive questions organized logically with conditional branching to skip irrelevant questions.
        </p>
        
        <h3>Question List (26 Questions)</h3>
        <table>
            <tr>
                <th>#</th>
                <th>Question</th>
                <th>Type</th>
                <th>Conditional Skip</th>
            </tr>
            <tr>
                <td>1</td>
                <td>What is your full name?</td>
                <td>Text</td>
                <td>None</td>
            </tr>
            <tr>
                <td>2</td>
                <td>What is your age?</td>
                <td>Number</td>
                <td>None</td>
            </tr>
            <tr>
                <td>3</td>
                <td>What is your weight? (in kg)</td>
                <td>Number</td>
                <td>None</td>
            </tr>
            <tr>
                <td>4</td>
                <td>What is your gender?</td>
                <td>Choice (M/F/O)</td>
                <td>None</td>
            </tr>
            <tr>
                <td>5</td>
                <td>What is your blood group?</td>
                <td>Choice (Blood Type)</td>
                <td>None</td>
            </tr>
            <tr>
                <td>6</td>
                <td>Do you have diabetes?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>7</td>
                <td>Do you have anemia or low hemoglobin?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>8</td>
                <td>What is your hemoglobin level?</td>
                <td>Text/Number</td>
                <td>None</td>
            </tr>
            <tr>
                <td>9</td>
                <td>What is your blood pressure?</td>
                <td>Number (numeric required)</td>
                <td>None</td>
            </tr>
            <tr>
                <td>10</td>
                <td>Did you previously suffer from COVID-19?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>11</td>
                <td>Do you have any allergies?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>12</td>
                <td>If yes, please specify your allergies:</td>
                <td>Text</td>
                <td>Skip if Q11 = No</td>
            </tr>
            <tr>
                <td>13</td>
                <td>Are you currently taking any medications?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>14</td>
                <td>If yes, please specify the medications:</td>
                <td>Text</td>
                <td>Skip if Q13 = No</td>
            </tr>
            <tr>
                <td>15</td>
                <td>Have you donated blood before?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>16</td>
                <td>If yes, when was your last donation?</td>
                <td>Text/Date</td>
                <td>Skip if Q15 = No</td>
            </tr>
            <tr>
                <td>17</td>
                <td>Do you have any chronic diseases?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>18</td>
                <td>If yes, please specify:</td>
                <td>Text</td>
                <td>Skip if Q17 = No</td>
            </tr>
            <tr>
                <td>19</td>
                <td>Do you have any infectious diseases? (HIV, Hepatitis, etc.)</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>20</td>
                <td>If yes, please specify:</td>
                <td>Text</td>
                <td>Skip if Q19 = No</td>
            </tr>
            <tr>
                <td>21</td>
                <td>Have you had any tattoos or piercings in the last 6 months?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>22</td>
                <td>If yes, when did you get them?</td>
                <td>Text/Date</td>
                <td>Skip if Q21 = No</td>
            </tr>
            <tr>
                <td>23</td>
                <td>Are you currently pregnant?</td>
                <td>Yes/No</td>
                <td>Skip if Q4 = Male</td>
            </tr>
            <tr>
                <td>24</td>
                <td>Are you currently breastfeeding?</td>
                <td>Yes/No</td>
                <td>Skip if Q4 = Male</td>
            </tr>
            <tr>
                <td>25</td>
                <td>Have you had any surgery in the last 6 months?</td>
                <td>Yes/No</td>
                <td>None</td>
            </tr>
            <tr>
                <td>26</td>
                <td>If yes, please specify:</td>
                <td>Text</td>
                <td>Skip if Q25 = No</td>
            </tr>
        </table>

        <h3>Answer Validation Rules</h3>
        <ul>
            <li><strong>Uncertain Answers Rejected:</strong> "Don't know", "idk", "N/A", "not sure" - User must re-answer</li>
            <li><strong>Age Validation:</strong> Must be a number (e.g., "25" not "twenty-five")</li>
            <li><strong>Weight Validation:</strong> Must be a number in kg (e.g., "60" or "72.5")</li>
            <li><strong>Gender Validation:</strong> Must be "Male", "Female", "Other" (or M/F/O)</li>
            <li><strong>Blood Type Validation:</strong> Must match format A+/A-/B+/B-/AB+/AB-/O+/O-</li>
            <li><strong>Blood Pressure Validation:</strong> Must contain at least one digit (e.g., "120/80")</li>
            <li><strong>Yes/No Questions:</strong> Accept "yes", "y", "true", "no", "n", "false"</li>
        </ul>

        <div class="page-break"></div>

        <!-- Frontend Features -->
        <h2>8. Frontend Features & User Interface</h2>
        
        <h3>Two-Tab Interface</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <strong>Chat Tab</strong>
                <p>Answer medical questions about blood donation in real-time. Features AI-generated follow-up recommendations.</p>
            </div>
            <div class="feature-card">
                <strong>Report Tab</strong>
                <p>Complete eligibility assessment questionnaire with progress tracking and comprehensive report generation.</p>
            </div>
        </div>
        
        <h3>Voice Features</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <strong>Speech Recognition</strong>
                <p>Voice input using Web Speech API. Supports Hindi, English, Spanish with auto-detection.</p>
            </div>
            <div class="feature-card">
                <strong>Text-to-Speech</strong>
                <p>Listen to AI responses with voice synthesis in multiple languages.</p>
            </div>
        </div>
        
        <h3>Interactive Components</h3>
        <ul>
            <li><strong>Real-time Message Streaming:</strong> Instant message display with smooth scrolling</li>
            <li><strong>Progress Bar:</strong> Visual representation of assessment completion</li>
            <li><strong>Typing Animation:</strong> Loading indicator while AI generates responses</li>
            <li><strong>Quick-Action Buttons:</strong> AI-generated recommendation buttons for suggested questions</li>
            <li><strong>Responsive Design:</strong> Mobile-first approach using TailwindCSS</li>
            <li><strong>Custom Scrollbar:</strong> Styled scrollbar for better UX</li>
            <li><strong>Material Icons:</strong> Semantic icons for different interaction types</li>
        </ul>

        <h3>Session Management</h3>
        <ul>
            <li>Session-based state tracking for question flow</li>
            <li>Separate user profiles via unique session IDs</li>
            <li>Profile data persistence across sessions</li>
            <li>Session reset functionality to start new assessments</li>
        </ul>

        <div class="page-break"></div>

        <!-- External Integrations -->
        <h2>9. External Integrations</h2>
        
        <h3>1. Tavily Search API</h3>
        <h4>Purpose</h4>
        <p>Real-time web search for blood banks, donation centers, and upcoming donation camps in user's city.</p>
        
        <h4>Configuration</h4>
        <ul>
            <li><strong>API Key:</strong> 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</li>
            <li><strong>Search Depth:</strong> Basic</li>
            <li><strong>Max Results:</strong> 7 per query</li>
        </ul>
        
        <h4>Data Processing</h4>
        <ul>
            <li>Classifies results as blood banks or camps based on keywords</li>
            <li>Filters "bank", "center", "hospital" for blood banks</li>
            <li>Filters "camp", "drive", "event" for donation camps</li>
            <li>Extracts title, content, and source URL</li>
        </ul>

        <h3>2. Indian Red Cross Organization</h3>
        <h4>URL</h4>
        <div class="code-block">
https://www.indianredcross.org/gujarat
        </div>
        
        <p>Used as fallback resource when Tavily search returns limited camp information.</p>

        <h3>3. Hugging Face Models Hub</h3>
        <h4>Models Used</h4>
        <ul>
            <li><strong>google/flan-t5-large:</strong> Main conversational AI model</li>
            <li><strong>sentence-transformers:</strong> Semantic embeddings (optional)</li>
        </ul>
        
        <p>Models are automatically downloaded on first initialization and cached locally.</p>

        <div class="page-break"></div>

        <!-- Deployment -->
        <h2>10. Deployment & Installation</h2>
        
        <h3>Requirements</h3>
        <div class="code-block">
Django>=4.2
djangorestframework
transformers>=4.30
torch                  # or torch-cpu for CPU-only
sentence-transformers
faiss-cpu             # optional
python-dotenv
gunicorn              # for production
        </div>

        <h3>Installation Steps</h3>
        <ol>
            <li>
                <strong>Clone Repository:</strong>
                <div class="code-block">
git clone https://github.com/mohitjanwani/blood-assistant.git
cd blood-assistant
                </div>
            </li>
            <li>
                <strong>Create Virtual Environment:</strong>
                <div class="code-block">
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
                </div>
            </li>
            <li>
                <strong>Install Dependencies:</strong>
                <div class="code-block">
pip install -r requirements.txt
                </div>
            </li>
            <li>
                <strong>Run Migrations:</strong>
                <div class="code-block">
python manage.py migrate
                </div>
            </li>
            <li>
                <strong>Create Superuser:</strong>
                <div class="code-block">
python manage.py createsuperuser
                </div>
            </li>
            <li>
                <strong>Run Development Server:</strong>
                <div class="code-block">
python manage.py runserver
                </div>
            </li>
            <li>
                <strong>Access Application:</strong>
                <div class="code-block">
http://localhost:8000
                </div>
            </li>
        </ol>

        <h3>Environment Variables (.env)</h3>
        <div class="code-block">
DEBUG=True
SECRET_KEY=your-secret-key-here
ALLOWED_HOSTS=localhost,127.0.0.1
TAVILY_API_KEY=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
        </div>

        <h3>Production Deployment (Gunicorn)</h3>
        <div class="code-block">
gunicorn blood_assistant.wsgi:application --bind 0.0.0.0:8000 --workers 4
        </div>

        <h3>Database Migration to PostgreSQL</h3>
        <p>
            For production, upgrade from SQLite to PostgreSQL by updating settings.py:
        </p>
        <div class="code-block">
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'blood_assistant_db',
        'USER': 'postgres',
        'PASSWORD': 'your-password',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
        </div>

        <div class="page-break"></div>

        <!-- Security & Best Practices -->
        <h2>11. Security & Best Practices</h2>
        
        <h3>Current Security Measures</h3>
        <ul>
            <li><strong>CSRF Protection:</strong> Django CSRF middleware enabled</li>
            <li><strong>Session Security:</strong> Session-based authentication for anonymous users</li>
            <li><strong>Input Validation:</strong> Strict validation on all user inputs</li>
            <li><strong>SQL Injection Prevention:</strong> Django ORM parameterized queries</li>
        </ul>
        
        <h3>Recommendations for Production</h3>
        <ul>
            <li>Use HTTPS with SSL/TLS certificates</li>
            <li>Set <code>DEBUG = False</code> in production</li>
            <li>Use strong <code>SECRET_KEY</code> (not hardcoded)</li>
            <li>Implement rate limiting on API endpoints</li>
            <li>Add user authentication for sensitive data</li>
            <li>Regular security audits and dependency updates</li>
            <li>Monitor API key exposure (rotate Tavily key)</li>
            <li>Implement data encryption for health information</li>
            <li>Add logging and monitoring for errors and suspicious activity</li>
        </ul>

        <h3>Data Privacy</h3>
        <ul>
            <li>User health data is stored in encrypted database</li>
            <li>Session-based approach for anonymous users (no personal login required)</li>
            <li>Comply with health data protection regulations (GDPR, HIPAA if applicable)</li>
            <li>Regular database backups</li>
        </ul>

        <div class="page-break"></div>

        <!-- Use Cases & Examples -->
        <h2>12. Use Cases & Example Scenarios</h2>
        
        <h3>Use Case 1: Checking Eligibility</h3>
        <p>
            <strong>User:</strong> A 28-year-old wants to know if they can donate blood.<br>
            <strong>Flow:</strong>
        </p>
        <ol>
            <li>User clicks "Generate Report" tab</li>
            <li>Clicks "Start Assessment" button</li>
            <li>System asks 26 questions about health, medical history, medications, etc.</li>
            <li>User answers all questions (skipping gender-specific questions)</li>
            <li>System evaluates eligibility against medical criteria</li>
            <li>Shows eligibility status: "Eligible" or "Not Eligible" with reasons</li>
            <li>User can download detailed HTML report</li>
        </ol>

        <h3>Use Case 2: Asking Medical Questions</h3>
        <p>
            <strong>User:</strong> "What are the health benefits of blood donation?"<br>
            <strong>Flow:</strong>
        </p>
        <ol>
            <li>User types question in Chat tab</li>
            <li>System classifies as EXPLAIN intent</li>
            <li>FLAN-T5 model generates comprehensive answer</li>
            <li>Shows recommendations: "Who can donate?", "Is donation safe?", "How often can I donate?"</li>
            <li>User can click recommendations or ask follow-up questions</li>
        </ol>

        <h3>Use Case 3: Finding Blood Banks</h3>
        <p>
            <strong>User:</strong> "Find blood banks near me in Surat"<br>
            <strong>Flow:</strong>
        </p>
        <ol>
            <li>User types location-based query in Chat tab</li>
            <li>System classifies as SEARCH intent</li>
            <li>Tavily API searches for blood banks in Surat</li>
            <li>Returns list of blood banks with addresses and links</li>
            <li>Also shows upcoming donation camps</li>
        </ol>

        <div class="page-break"></div>

        <!-- Future Enhancements -->
        <h2>13. Future Enhancements & Roadmap</h2>
        
        <h3>Short-term Improvements</h3>
        <ul>
            <li>Add user authentication and profile management</li>
            <li>Implement SMS/Email notifications for donation camps</li>
            <li>Add more language support (Gujarati, Marathi, Tamil, etc.)</li>
            <li>Mobile app development (React Native/Flutter)</li>
            <li>Appointment booking system for blood donation</li>
        </ul>
        
        <h3>Medium-term Features</h3>
        <ul>
            <li>Integration with hospitals and blood banks API</li>
            <li>Blood inventory management system</li>
            <li>Donor scheduling and reminder system</li>
            <li>Community gamification (badges, achievements)</li>
            <li>Blood requirement alerts for emergency situations</li>
        </ul>
        
        <h3>Long-term Vision</h3>
        <ul>
            <li>AI-powered predictive analytics for blood demand forecasting</li>
            <li>Machine learning model for personalized donation recommendations</li>
            <li>Blockchain-based blood donation tracking</li>
            <li>Integration with national blood bank database</li>
            <li>Multi-country expansion with localized guidelines</li>
        </ul>

        <!-- Troubleshooting -->
        <h2>14. Troubleshooting & FAQ</h2>
        
        <h3>Common Issues</h3>
        
        <h4>Issue: Model takes too long to load</h4>
        <p>
            <strong>Solution:</strong> First initialization downloads FLAN-T5 (large model). Subsequent requests are faster. 
            Consider using quantized model versions or GPU acceleration.
        </p>
        
        <h4>Issue: Tavily API not returning results</h4>
        <p>
            <strong>Solution:</strong> Check API key validity and internet connection. Ensure city name is correctly identified. 
            Supported cities: Ahmedabad, Surat, Vadodara (configurable).
        </p>
        
        <h4>Issue: Voice input not working</h4>
        <p>
            <strong>Solution:</strong> Ensure browser supports Web Speech API (Chrome, Edge, Firefox). Grant microphone permissions. 
            Check system audio input devices.
        </p>
        
        <h4>Issue: Assessment not saving data</h4>
        <p>
            <strong>Solution:</strong> Verify database connection. Check if migrations are applied. Review Django logs for database errors.
        </p>

        <!-- Conclusion -->
        <h2>15. Conclusion</h2>
        
        <p>
            <strong>Blood Assistant AI</strong> is a comprehensive, production-ready application that combines modern web technologies 
            with advanced AI/ML capabilities to make blood donation accessibility and eligibility assessment easier than ever. 
            The system leverages transformer-based language models, intelligent API integrations, and user-friendly interface design 
            to provide accurate, helpful guidance to potential blood donors.
        </p>
        
        <p>
            With its modular architecture, comprehensive validation, and extensible design, the application is well-positioned for 
            future enhancements and scaling to support more users and regions. The focus on medical accuracy, user experience, and 
            data security makes it a reliable tool for healthcare organizations and individuals alike.
        </p>

        <footer>
            <p>
                <strong>Blood Assistant AI - Complete Project Documentation</strong><br>
                Repository: <strong>blood-assistant</strong> | Owner: <strong>mohitjanwani</strong><br>
                Generated: November 27, 2025<br>
                Â© 2025 Blood Assistant. All rights reserved.
            </p>
        </footer>
    </div>
</body>
</html>
